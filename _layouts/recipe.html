---
layout: default
---
<!-- template: recipe.html -->

{%- comment -%}
---- VARS ------------------------------------------------
{%- endcomment -%}

{%- if page.photo_large -%}
  {%- assign photo_hero = page.photo_large -%}
{%- elsif page.photos[0].filename -%}
  {%- assign photo_hero = page.photos[0].filename -%}
{%- comment -%}
{%- elsif page.photo -%}
  {%- assign photo_hero = page.photo -%}
{%- endcomment -%}
{%- else -%}
  {%- assign photo_hero = nil -%}
{%- endif -%}

{% if page.type == "_mine" %}
  {%- assign class_mine = "mine" -%}
{% else %}
  {%- assign class_mine = "notmine" -%}
{% endif %}

{%- comment -%}
---- END VARS ------------------------------------------------
{%- endcomment -%}
<!--pre>{{ page.created_ts }}</pre-->
<div class="{{ class_mine }}" id="recipe">
<div class="row" id="title">
	<div class="small-12 columns">
    <h2 class="marker">{% if page.type == "_mine" %}Joi's {% endif %}{{ page.title }}</h2>

    {% if page.source %}
      <p class="source">Source: 
        {% unless page.source_url %}
          {{ page.source }}
        {% else %}
          <a href="{{ page.source_url }}" title="{{ page.source }}">{{ page.source }}</a>
        {% endunless %}
      </p>
    {% endif %}

  </div>
</div>

{%- if photo_hero -%}
<!-- Hero Banner Photo -->
<div class="row" id="big-photo">
	<div class="small-12 columns">
		<img src="/images/recipes/{{page.uid}}/{{photo_hero}}">
	</div>
</div>
<!-- End Hero Banner Photo -->
{%- else -%}
  {%- comment -%}<hr>{%- endcomment -%}
{%- endif -%}

{% comment %}
Hack. 
Most of the content is templated in our Python script and inserted into
the markdown file. However, we open this DIV and place the backlinks include
here, since we cannot invoke another Liquid template over in the Python.
We do the same at the bottom to include the Photostrip. 
hacky, but it works.
For now.
- B. 2021-03-05
{% endcomment %}
<div class="row" id="row-one">
  <div class="large-4 medium-5" id="backlinks">
    <div class="bgc-lorange">{%- include backlinks.html -%}</div>
    &nbsp;
  </div>
{%- include content.html -%}
{% comment %}
- Row Two is opened and populated over in the Python script.
  We just append the photostrip here and close it.
- The old photostrip column is opened in the Python script
  So that we can conditionally insert the Recipe<->Post/Meal Date links
  <div class="medium-2 columns" id="photo-sidebar">
{% endcomment %}
{% assign pp_recipe_id = page.p_recipe_id | downcase %}
{% assign mbrd_dict = site.data.meals_indices.meal_by_recipe_and_date[pp_recipe_id] %}
{% if mbrd_dict %}
<div class="" id="meals">
  <h4>Prepared</h4>
  <ul>
  {% for meal in mbrd_dict reversed %}
    <li>
      {% comment %}
      Assemble the theoretical Note's URI Path.
      We will use this first to see if the Note exists, and then, if it does, to link to it.
      {% endcomment %}
      {% assign day = meal[0] | split: "-" %}
      {% capture note_path %}/{{ day[0] }}/{{ day[1] }}/{{ day[2] }}/notes/{{ meal[1] | downcase }}-{{ page.filename }}{% endcapture %}
      <!-- {% capture obs_path %}%2F_notes%2F{{ meal[0] }}-{{ meal[1] | downcase }}-{{ page.filename }}{% endcapture %} -->
      {% capture obs_path %}_notes%2F{{ meal[0] }}-{{ meal[1] | downcase }}-{{ page.filename }}{% endcapture %}
      {% comment %}
      Here we check to see if the Note exists
      {% endcomment %}
      {% assign result = site.notes | where: "url", note_path %}
      
      {% if result[0] %}
        {% comment %}
        If it does, we link to it.
        {% endcomment %}
        <a href="{{ note_path }}">
      
      {% elsif jekyll.environment == 'development' %}
        {% comment %}
        If it does not, we link to Obsidian, giving us a pathway to creating it.
        {% endcomment %}
        <!-- <a class="no-endpoint-link"
          href="obsidian://new?vault=joi.github.io&path={{ obs_path }}"> -->
        <a class="no-endpoint-link"
          href="obsidian://new?vault=joi.github.io&file={{ obs_path }}">
      {% else %}
        <a class="dead-link">
      {% endif %}
        <em>{{ meal[1] }}</em>
        <strong>{{ meal[0] | date_to_string: "ordinal", "US" }}</strong>
        </a>
    </li>
  {% endfor %}
  </ul>
</div>
{% endif %}

  </div><!-- #photo-sidebar -->
</div><!-- #row-two -->

{% comment %}
We don't need this do we? 
I have it here and in the Python script.
{% if page.type == "_mine" %}
  {% if page.html['nutrition'] != null %}
  <hr>
  <div class="row" id="row-three">
    <div class="small-12 columns">
        <h4 id="nutrition">Nutritional Facts</h4>
        <div class="box box-nutrition">
          {{ page.html['nutrition'] }}
        </div>
    </div>
  </div><!-- #row-three -->
  {% endif %}
{% endif %}
{% endcomment %}

<hr>
<div class="row" id="row-four">
  <div class="small-12 columns" id="copyright">
      <h6>Recipe Copyright</h6>
      <div class="box">
        <p><a href="https://www.copyright.gov/help/faq/faq-protect.html">According to the US Copyright Office</a>:</p>
          <blockquote>
            "A mere listing of ingredients is not protected under copyright law. 
            However, where a recipe or formula is accompanied by substantial literary expression in the form of an explanation or directions, 
            or when there is a collection of recipes as in a cookbook, there may be a basis for copyright protection."
          </blockquote>
        <p>On this site, for recipes written by others, the ingredients are listed and a link to the original recipe has been provided.</p>
      </div>
  </div>
</div><!-- #row-three -->

</div><!-- .mine / .notmine -->

<!-- /template: recipe.html -->